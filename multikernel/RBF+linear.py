#!/usr/bin/python
"""multi kernel example.

Author: Su Yuehua
Copyright (c) 2018, Su Yuehua.

"""

import numpy as np
from sklearn import svm
import pylab as pl
import matplotlib.pyplot as plt
from multikernel.mSVC import RBF, MultiKernelSVC, linear

if __name__ == '__main__':


    x=np.array([[4.54 ,4.62 ],[2.46 ,3.29 ],[3.80 ,4.14 ],[3.50 ,5.69 ],[4.38 ,4.17 ],[4.41 ,2.53 ],[4.41 ,2.79 ],[3.64 ,3.76 ],[3.40 ,3.73 ],[3.41 ,2.78 ],[4.85 ,4.26 ],[2.15 ,5.79 ],[3.79 ,3.64 ],[4.27 ,3.71 ],[3.35 ,0.89 ],[4.48 ,2.90 ],[3.93 ,2.03 ],[3.06 ,3.45 ],[4.16 ,4.74 ],[3.73 ,6.15 ],[3.59 ,6.54 ],[3.29 ,3.83 ],[4.06 ,3.55 ],[2.15 ,5.16 ],[3.60 ,4.69 ],[3.46 ,5.08 ],[3.09 ,5.10 ],[4.65 ,1.91 ],[3.27 ,4.76 ],[4.54 ,3.87 ],[4.98 ,2.92 ],[3.84 ,3.02 ],[4.28 ,5.81 ],[4.64 ,2.85 ],[3.92 ,2.25 ],[4.54 ,4.30 ],[2.74 ,6.84 ],[5.11 ,4.04 ],[3.01 ,4.44 ],[2.17 ,2.67 ],[5.38 ,6.37 ],[3.94 ,4.18 ],[4.45 ,4.75 ],[3.64 ,2.65 ],[2.98 ,5.21 ],[0.93 ,4.55 ],[4.63 ,2.37 ],[3.71 ,4.06 ],[3.80 ,3.36 ],[4.41 ,4.15 ],[2.58 ,3.65 ],[3.27 ,3.73 ],[5.15 ,2.54 ],[4.60 ,3.54 ],[2.72 ,5.08 ],[1.80 ,6.47 ],[3.43 ,2.36 ],[4.21 ,7.36 ],[4.94 ,6.16 ],[4.09 ,4.24 ],[2.88 ,3.57 ],[4.31 ,3.01 ],[2.83 ,5.18 ],[3.04 ,3.02 ],[3.35 ,3.35 ],[2.77 ,5.25 ],[3.73 ,4.62 ],[3.10 ,5.27 ],[3.71 ,4.71 ],[3.54 ,3.43 ],[3.59 ,3.27 ],[3.50 ,5.13 ],[5.23 ,3.05 ],[4.61 ,5.68 ],[4.06 ,5.12 ],[2.53 ,4.41 ],[2.37 ,4.00 ],[2.04 ,4.52 ],[6.61 ,8.99 ],[4.97 ,3.84 ],[4.26 ,1.80 ],[3.03 ,6.71 ],[2.85 ,4.86 ],[4.55 ,3.08 ],[5.57 ,7.70 ],[2.31 ,4.78 ],[3.55 ,4.42 ],[3.92 ,2.90 ],[2.01 ,2.49 ],[4.84 ,1.50 ],[3.59 ,3.40 ],[5.91 ,2.51 ],[3.61 ,4.92 ],[4.41 ,3.55 ],[2.86 ,6.50 ],[3.38 ,6.14 ],[2.83 ,4.23 ],[4.39 ,3.60 ],[5.30 ,5.63 ],[3.41 ,2.38 ],[7.67 ,6.94 ],[6.33 ,6.13 ],[6.60 ,8.86 ],[6.33 ,4.94 ],[7.58 ,4.54 ],[6.22 ,7.29 ],[5.94 ,8.69 ],[7.55 ,5.86 ],[6.58 ,5.21 ],[7.36 ,6.79 ],[6.65 ,4.69 ],[7.27 ,7.02 ],[4.44 ,8.17 ],[7.47 ,7.31 ],[8.85 ,4.30 ],[8.04 ,6.24 ],[7.91 ,6.57 ],[6.76 ,9.56 ],[7.18 ,8.29 ],[7.24 ,6.92 ],[7.10 ,8.85 ],[6.17 ,5.52 ],[6.65 ,6.51 ],[6.83 ,9.00 ],[6.52 ,9.12 ],[7.84 ,8.03 ],[9.54 ,7.69 ],[5.68 ,6.17 ],[7.13 ,8.05 ],[5.56 ,5.83 ],[8.30 ,7.81 ],[8.41 ,7.40 ],[5.34 ,8.61 ],[8.94 ,6.40 ],[5.92 ,7.90 ],[7.23 ,8.12 ],[8.10 ,5.73 ],[7.15 ,7.22 ],[9.30 ,9.26 ],[9.75 ,7.16 ],[7.14 ,6.56 ],[5.09 ,7.65 ],[6.64 ,6.61 ],[6.15 ,7.63 ],[6.24 ,6.81 ],[5.87 ,6.97 ],[7.08 ,7.65 ],[9.11 ,8.93 ],[6.28 ,7.64 ],[6.72 ,9.33 ],[8.17 ,4.13 ],[8.21 ,6.36 ],[7.49 ,7.33 ],[8.03 ,5.82 ],[7.87 ,5.20 ],[6.62 ,7.87 ],[7.43 ,7.87 ],[6.70 ,7.41 ],[6.10 ,7.56 ],[7.63 ,5.77 ],[7.07 ,6.30 ],[6.81 ,6.85 ],[7.29 ,6.03 ],[7.99 ,7.47 ],[7.39 ,10.34 ],[7.19 ,6.32 ],[7.28 ,7.92 ],[7.05 ,5.54 ],[6.23 ,8.89 ],[7.79 ,5.63 ],[8.41 ,7.30 ],[6.47 ,6.13 ],[8.93 ,7.72 ],[6.82 ,7.02 ],[6.76 ,6.94 ],[6.10 ,11.17 ],[6.21 ,6.11 ],[6.05 ,6.93 ],[7.35 ,10.79 ],[8.60 ,5.38 ],[7.53 ,7.78 ],[7.85 ,5.48 ],[8.34 ,8.46 ],[4.50 ,7.46 ],[6.83 ,7.92 ],[7.35 ,6.61 ],[7.72 ,7.35 ],[5.70 ,9.08 ],[5.99 ,3.78 ],[7.79 ,4.69 ],[6.88 ,7.59 ],[7.55 ,6.07 ],[6.04 ,6.58 ],[5.37 ,4.88 ],[7.76 ,5.72 ],[8.19 ,6.43 ],[8.63 ,5.97 ],[5.47 ,5.77 ],[5.66 ,6.40 ],[5.53 ,5.67 ]])
    y=[0]*100+[1]*100
    y = np.array(y, dtype=np.int)
    pic=plt.scatter(x[:,0],x[:,1],c=y,s=50,alpha=0.9)
    #
    kernels = [RBF(10 ** k) for k in range(-5, 0)]  # some RBF kernels
    kernels.append(linear)  # Add linear kernel

    clf = MultiKernelSVC(kernels=kernels, C=1e6, verbose=True, maxit=100,
                         tol=1e-5, p=1, store_objective=True)
    svc=clf.fit(x, y)
    X, Y = np.mgrid[0:15:200j, 0:15:200j]
    Z = clf.predict(np.c_[X.ravel(), Y.ravel()])
    Z = Z.reshape(X.shape)
    plt.contourf(X, Y, Z > 0, alpha=0.4)
    plt.contour(X, Y, Z, colors=['k'], linestyles=['-'], levels=[0])
    plt.scatter(x[:, 0], x[:, 1], c=y, s=50, alpha=0.9)
    pl.axis('tight')
    pl.show()
